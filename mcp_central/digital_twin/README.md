# Digital Twin MCP

è¿™æ˜¯ä¸€ä¸ªæ•°å­—åˆ†èº«MCPæœåŠ¡å™¨ï¼Œå¯ä»¥ä½œä¸ºæ‰‹æœºç”¨æˆ·çš„ç§äººåŠ©æ‰‹ï¼Œæ”¯æŒå¯¼å…¥å¾®ä¿¡èŠå¤©è®°å½•å¹¶æä¾›ä¸ªæ€§åŒ–é—®ç­”æœåŠ¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

1. **å¾®ä¿¡èŠå¤©è®°å½•å¯¼å…¥**: æ”¯æŒå¯¼å…¥å¾®ä¿¡èŠå¤©è®°å½•ï¼ŒåŒ…æ‹¬å‘é€å’Œæ¥æ”¶çš„æ¶ˆæ¯
2. **ç”¨æˆ·ç”»åƒåˆ†æ**: åŸºäºèŠå¤©è®°å½•è‡ªåŠ¨åˆ†æç”¨æˆ·çš„å…´è¶£çˆ±å¥½ã€æ€§æ ¼ç‰¹å¾ã€æ²Ÿé€šé£æ ¼ç­‰
3. **ä¸ªæ€§åŒ–é—®ç­”**: æ ¹æ®ç”¨æˆ·ç”»åƒæä¾›ä¸ªæ€§åŒ–çš„å›ç­”å’Œå»ºè®®
4. **æ•°æ®ç»Ÿè®¡**: æä¾›èŠå¤©è®°å½•çš„ç»Ÿè®¡ä¿¡æ¯

## å®‰è£…

```bash
pip install -r requirements.txt
```

## MCP é…ç½®

```json
{
  "mcpServers": {
    "digital_twin": {
      "command": "/path/to/fastmcp",
      "args": [
        "run",
        "/path/to/mcp-central/mcp_central/digital_twin/server.py"
      ]
    }
  }
}
```

å°†æ­¤é…ç½®æ·»åŠ åˆ°ä½ çš„èŠå¤©æœºå™¨äººæˆ–æ™ºèƒ½ä½“é…ç½®æ–‡ä»¶ä¸­ä»¥ä½¿ç”¨æ•°å­—åˆ†èº«MCPæœåŠ¡å™¨ã€‚

## åŠŸèƒ½è¯´æ˜

### 1. create_user
åˆ›å»ºæ–°ç”¨æˆ·å¹¶è¿”å›ç”¨æˆ·IDã€‚

**è¾“å…¥å‚æ•°:**
- `name` (string): ç”¨æˆ·å§“å
- `phone` (string, å¯é€‰): ç”¨æˆ·æ‰‹æœºå·

**è¾“å‡º:**
```json
{
  "success": true,
  "user_id": 1,
  "message": "ç”¨æˆ·å¼ ä¸‰åˆ›å»ºæˆåŠŸï¼Œç”¨æˆ·ID: 1"
}
```

### 2. import_wechat_messages
å¯¼å…¥å¾®ä¿¡èŠå¤©è®°å½•ã€‚

**è¾“å…¥å‚æ•°:**
- `user_id` (int): ç”¨æˆ·ID
- `messages_json` (string): JSONæ ¼å¼çš„æ¶ˆæ¯æ•°ç»„

æ¶ˆæ¯æ ¼å¼ç¤ºä¾‹:
```json
[
  {
    "message_type": "sent",
    "content": "ä»Šå¤©å¤©æ°”çœŸä¸é”™",
    "timestamp": "2024-01-15 10:30:00",
    "contact_name": "å°æ˜"
  },
  {
    "message_type": "received", 
    "content": "æ˜¯å•Šï¼Œé€‚åˆå‡ºå»èµ°èµ°",
    "timestamp": "2024-01-15 10:31:00",
    "contact_name": "å°æ˜"
  }
]
```

**è¾“å‡º:**
```json
{
  "imported_count": 2,
  "total_messages": 2,
  "success": true
}
```

### 3. analyze_user
åŸºäºå·²å¯¼å…¥çš„èŠå¤©è®°å½•åˆ†æç”¨æˆ·ç”»åƒã€‚

**è¾“å…¥å‚æ•°:**
- `user_id` (int): ç”¨æˆ·ID

**è¾“å‡º:**
```json
{
  "success": true,
  "profile": {
    "interests": ["è¿åŠ¨", "éŸ³ä¹", "ç¾é£Ÿ"],
    "personality": {
      "æ´»è·ƒåº¦": "ä¸­ç­‰",
      "å¹½é»˜æ„Ÿ": "ä¸€èˆ¬", 
      "è¡¨è¾¾æ–¹å¼": "ç›´æ¥",
      "æƒ…ç»ªå€¾å‘": "ç§¯æä¹è§‚"
    },
    "communication_style": {
      "æ¶ˆæ¯é•¿åº¦": "ç®€æ´",
      "è¡¨æƒ…ä½¿ç”¨": "é€‚ä¸­",
      "å›å¤é€Ÿåº¦": "åŠæ—¶"
    },
    "frequent_topics": ["å·¥ä½œ", "ç”Ÿæ´»", "è¿åŠ¨"]
  }
}
```

### 4. personalized_qa
åŸºäºç”¨æˆ·ç”»åƒæä¾›ä¸ªæ€§åŒ–é—®ç­”ã€‚

**è¾“å…¥å‚æ•°:**
- `user_id` (int): ç”¨æˆ·ID
- `question` (string): ç”¨æˆ·é—®é¢˜

**è¾“å‡º:**
```json
{
  "success": true,
  "response": "ğŸ˜Š ç®€å•æ¥è¯´ï¼šåŸºäºä½ å¹³æ—¶å–œæ¬¢è¿åŠ¨ï¼Œæˆ‘å»ºè®®ä½ å¯ä»¥å°è¯•ä¸€äº›æˆ·å¤–æ´»åŠ¨..."
}
```

### 5. get_chat_stats
è·å–ç”¨æˆ·çš„èŠå¤©è®°å½•ç»Ÿè®¡ä¿¡æ¯ã€‚

**è¾“å…¥å‚æ•°:**
- `user_id` (int): ç”¨æˆ·ID

**è¾“å‡º:**
```json
{
  "success": true,
  "stats": {
    "total_messages": 150,
    "sent_messages": 75,
    "received_messages": 75,
    "contact_count": 12
  }
}
```

## æ•°æ®å­˜å‚¨

ç³»ç»Ÿä½¿ç”¨SQLiteæ•°æ®åº“å­˜å‚¨æ•°æ®ï¼ŒåŒ…å«ä»¥ä¸‹è¡¨ï¼š

- `users`: ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
- `chat_records`: èŠå¤©è®°å½•
- `user_profile`: ç”¨æˆ·ç”»åƒæ•°æ®

æ•°æ®åº“æ–‡ä»¶é»˜è®¤ä¸º `digital_twin.db`ï¼Œä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºã€‚

## ä½¿ç”¨ç¤ºä¾‹

1. **åˆ›å»ºç”¨æˆ·**
```python
# åˆ›å»ºç”¨æˆ·
result = await create_user("å¼ ä¸‰", "13800138000")
user_id = json.loads(result)["user_id"]
```

2. **å¯¼å…¥èŠå¤©è®°å½•**
```python
# å‡†å¤‡èŠå¤©æ•°æ®
messages = [
    {
        "message_type": "sent",
        "content": "ä»Šå¤©å»å¥èº«æˆ¿äº†ï¼Œæ„Ÿè§‰å¾ˆæ£’ï¼",
        "timestamp": "2024-01-15 18:30:00",
        "contact_name": "å¥èº«ä¼™ä¼´"
    },
    {
        "message_type": "received",
        "content": "å“‡ï¼ŒåšæŒå¾—çœŸå¥½ï¼",
        "timestamp": "2024-01-15 18:31:00", 
        "contact_name": "å¥èº«ä¼™ä¼´"
    }
]

# å¯¼å…¥æ•°æ®
result = await import_wechat_messages(user_id, json.dumps(messages))
```

3. **åˆ†æç”¨æˆ·ç”»åƒ**
```python
# åˆ†æç”¨æˆ·
profile = await analyze_user(user_id)
```

4. **ä¸ªæ€§åŒ–é—®ç­”**
```python
# æé—®
response = await personalized_qa(user_id, "æ¨èä¸€äº›é€‚åˆæˆ‘çš„è¿åŠ¨")
```

## æ³¨æ„äº‹é¡¹

1. èŠå¤©è®°å½•ä¸­çš„æ—¶é—´æˆ³æ ¼å¼åº”ä¸º `YYYY-MM-DD HH:MM:SS`
2. ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†æä¸­æ–‡æ–‡æœ¬ï¼Œæå–å…³é”®ä¿¡æ¯æ„å»ºç”¨æˆ·ç”»åƒ
3. ä¸ªæ€§åŒ–å›ç­”åŸºäºç®€å•çš„è§„åˆ™å¼•æ“ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ‰©å±•æ›´å¤æ‚çš„AIæ¨¡å‹
4. æ•°æ®åº“æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œè¯·æ³¨æ„æ•°æ®å®‰å…¨å’Œéšç§ä¿æŠ¤

## æ‰©å±•å»ºè®®

1. **å¢å¼ºæ–‡æœ¬åˆ†æ**: é›†æˆæ›´å¼ºå¤§çš„NLPæ¨¡å‹è¿›è¡Œæƒ…æ„Ÿåˆ†æå’Œä¸»é¢˜æå–
2. **å¤šæ¨¡æ€æ”¯æŒ**: æ”¯æŒå›¾ç‰‡ã€è¯­éŸ³ç­‰å¤šåª’ä½“æ¶ˆæ¯åˆ†æ
3. **ä¸ªæ€§åŒ–æ¨è**: åŸºäºç”¨æˆ·ç”»åƒæä¾›æ›´ç²¾å‡†çš„å†…å®¹æ¨è
4. **éšç§ä¿æŠ¤**: æ·»åŠ æ•°æ®åŠ å¯†å’ŒåŒ¿ååŒ–å¤„ç†
5. **å®æ—¶å­¦ä¹ **: æ”¯æŒåŸºäºç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–ç”¨æˆ·ç”»åƒ

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªé¡¹ç›®æ ¹ç›®å½•çš„LICENSEæ–‡ä»¶ã€‚
